$.fn.turkLirasi=function(options){var settings=$.extend({allowedDecimal:true,maxDecimalCount:2,autoFillDecimal:true,suffix:'TL',formatted:true,autoSelect:true,align:'right',_eventAfterSet:false,_eventFocusOut:false,debug:false},options);var number_format=function(number,decimals,dec_point,thousands_sep){number=(number+'').replace(/[^0-9+\-Ee.]/g,'');var n=!isFinite(+number)?0:+number,prec=!isFinite(+decimals)?0:Math.abs(decimals),sep=(typeof thousands_sep==='undefined')?',':thousands_sep,dec=(typeof dec_point==='undefined')?'.':dec_point,s='',toFixedFix=function(n,prec){var k=Math.pow(10,prec);return''+Math.round(n*k)/k};s=(prec?toFixedFix(n,prec):''+Math.round(n)).split('.');if(s[0].length>3){s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)}if((s[1]||'').length<prec){s[1]=s[1]||'';s[1]+=new Array(prec-s[1].length+1).join('0')}return s.join(dec)};var log=function(activeElement,value){if(activeElement.data('options').debug){console.log(value)}};var checkValue=function(value){if(value==0)return'';return value};var completeValue=function(value){if(value=='')return 0;return value};var getSuffix=function(suffix){if(suffix==false){return''}return' '+suffix};var setDecimalPoint=function(element,value){element.data('decimalPoint',value)};var getDecimalPoint=function(element){return element.data('decimalPoint')};var setDefaultValue=function(element){if(element.data('options').allowedDecimal&&element.data('options').autoFillDecimal){element.data('value','0');element.data('visualValue','0,00');setDecimalPoint(element,true);element.val(element.data('visualValue')+getSuffix(element.data('options').suffix))}else{element.data('value',0);element.data('visualValue','0');setDecimalPoint(element,false);element.val(element.data('visualValue')+getSuffix(element.data('options').suffix))}};var methodDefined=function(element,method){if(element.data('options')[method]!=false){return true}return false};var setValue=function(element,value,initialization){value=''+value;value=value.replace('.',',');element.data('value',value);sections=value.split(',');if(element.data('options').formatted){var visualValue=number_format(sections[0],0,',','.')}else{var visualValue=value}if(typeof sections[1]!='undefined'){setDecimalPoint(element,true);visualValue+=','+sections[1]}else{setDecimalPoint(element,false)}element.data('visualValue',visualValue);element.val(element.data('visualValue')+getSuffix(element.data('options').suffix));log(element,element.data());if(typeof initialization=='undefined'&&methodDefined(element,'_eventAfterSet')){element.trigger('change',element.data('options')._eventAfterSet)}};var checkSelectAll=function(element){if(element.data('selectAll')==true){setDefaultValue(element);element.data('selectAll',false);return true}return false};var init=function(element,options){element.data('options',options);var firstValue=element.val();firstValue=firstValue.replace(/\./g,'').replace(',','.');firstValue=parseFloat(firstValue);if(isNaN(firstValue)){setDefaultValue(element)}else{setValue(element,firstValue,true)}};return this.each(function(){var activeElement=$(this);var options=$.meta?$.extend({},settings,activeElement.data()):settings;setDecimalPoint(activeElement,false);activeElement.css('text-align',options.align);activeElement.data('selectAll',true);init(activeElement,options);$(this).click(function(){if(activeElement.data('options').autoSelect){activeElement.select();activeElement.data('selectAll',true);log(activeElement,'Tüm metin seçildi.')}});$(this).focusout(function(){if(activeElement.data('options').allowedDecimal&&activeElement.data('options').autoFillDecimal){if(activeElement.data('value')!=''&&activeElement.data('value')!='0'){sections=activeElement.data('value').split(',');if(typeof sections[1]=='undefined'){var fark=activeElement.data('options').maxDecimalCount}else{var fark=activeElement.data('options').maxDecimalCount-sections[1].length}var fillText='';for(var i=1;i<=fark;i++){fillText+='0'}if(!getDecimalPoint(activeElement)){fillText=','+fillText}setDecimalPoint(activeElement,true);activeElement.data('value',activeElement.data('value')+fillText);activeElement.data('visualValue',activeElement.data('visualValue')+fillText);activeElement.val(activeElement.data('visualValue')+getSuffix(activeElement.data('options').suffix))}}if(methodDefined(activeElement,'_eventFocusOut')){activeElement.trigger('change',activeElement.data('options')._eventFocusOut)}});$(this).focus(function(){$(this).trigger('click')});$(this).on('setAgain',function(event,newValue){newValue=''+newValue;newValue=newValue.replace(/\./g,'').replace(',','.');setValue($(this),newValue)});$(this).keydown(function(e){var activeElement=$(this);var suffix='';if(options.suffix!=''&&options.suffix!=false){suffix=' '+options.suffix}var key=e.charCode||e.keyCode||0;log(activeElement,'Pressed Key Code: #'+key);if((e.ctrlKey||e.metaKey)&&key==86){activeElement.val('');setTimeout(function(e){var realValue=activeElement.val();realValue=realValue.replace(/\./g,'').replace(',','.');realValue=parseFloat(realValue);setValue(activeElement,realValue)},0);return true}else if((e.ctrlKey||e.metaKey)&&key==67){return true}else if(key==9||key==39||key==40){activeElement.data('selectAll',false);return true}else if(key==8){if(checkSelectAll(activeElement)){return false}var realValue=checkValue(activeElement.data('value'));if(realValue.substr(realValue.length-1)==','){setDecimalPoint(activeElement,false)}realValue=realValue.substr(0,realValue.length-1);realValue=completeValue(realValue);setValue(activeElement,realValue);log(activeElement,activeElement.data())}else if(key==188&&activeElement.data('options').allowedDecimal&&getDecimalPoint(activeElement)==false){var realValue=checkValue(activeElement.data('value'));realValue=realValue+',';setValue(activeElement,realValue);log(activeElement,activeElement.data())}else if((key>=48&&key<=57)||(key>=96&&key<=105)){checkSelectAll(activeElement);var realValue=checkValue(activeElement.data('value'));var sections=realValue.split(',');if(getDecimalPoint(activeElement)){if(typeof sections[1]!='undefined'&&sections[1].length==options.maxDecimalCount){return false}}if(key>=48&&key<=57){realValue=realValue+String.fromCharCode(e.keyCode)}else{var values={96:"0",97:"1",98:"2",99:"3",100:"4",101:"5",102:"6",103:"7",104:"8",105:"9"};realValue=realValue+values[key]}realValue=completeValue(realValue);setValue(activeElement,realValue);log(activeElement,activeElement.data())}else{return false}return false})})};